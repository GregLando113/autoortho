#
# Create an 'unstable' release from the main branch
#

name: Unstable Release

on:
  #schedule:
  #  - cron: '0 5 * * *'
  workflow_dispatch:
  pull_request:
  push:
    branches: [ main ]

jobs:
  getcalver:
    runs-on: ubuntu-latest
    outputs:
      calver: ${{ steps.getcalver.outputs.CALVER }}
    steps:
      - name: Get CalVer
        id: getcalver
        run: |
          echo "CALVER="$(date +%Y.%m.%d.%H.%M.%S) > $GITHUB_OUTPUT

  build:
    needs: getcalver 
    uses: ./.github/workflows/build_release.yml
    with:
      version: ${{ needs.getcalver.outputs.calver }}
      relname: unstable 
